{"version":3,"file":"sidebar.js","sources":["../src/util/index.js","../src/sidebar.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v4.3.1): util/index.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nconst MAX_UID = 1000000\nconst MILLISECONDS_MULTIPLIER = 1000\nconst TRANSITION_END = 'transitionend'\n\n// Shoutout AngusCroll (https://goo.gl/pxwQGp)\nconst toType = obj => ({}.toString.call(obj).match(/\\s([a-z]+)/i)[1].toLowerCase())\n\n/**\n * --------------------------------------------------------------------------\n * Public Util Api\n * --------------------------------------------------------------------------\n */\n\nconst getUID = prefix => {\n  do {\n    prefix += ~~(Math.random() * MAX_UID) // \"~~\" acts like a faster Math.floor() here\n  } while (document.getElementById(prefix))\n\n  return prefix\n}\n\nconst getSelector = element => {\n  let selector = element.getAttribute('data-target')\n\n  if (!selector || selector === '#') {\n    const hrefAttr = element.getAttribute('href')\n\n    selector = hrefAttr && hrefAttr !== '#' ? hrefAttr.trim() : null\n  }\n\n  return selector\n}\n\nconst getSelectorFromElement = element => {\n  const selector = getSelector(element)\n\n  if (selector) {\n    return document.querySelector(selector) ? selector : null\n  }\n\n  return null\n}\n\nconst getElementFromSelector = element => {\n  const selector = getSelector(element)\n\n  return selector ? document.querySelector(selector) : null\n}\n\nconst getTransitionDurationFromElement = element => {\n  if (!element) {\n    return 0\n  }\n\n  // Get transition-duration of the element\n  let {\n    transitionDuration,\n    transitionDelay\n  } = window.getComputedStyle(element)\n\n  const floatTransitionDuration = parseFloat(transitionDuration)\n  const floatTransitionDelay = parseFloat(transitionDelay)\n\n  // Return 0 if element or transition duration is not found\n  if (!floatTransitionDuration && !floatTransitionDelay) {\n    return 0\n  }\n\n  // If multiple durations are defined, take the first\n  transitionDuration = transitionDuration.split(',')[0]\n  transitionDelay = transitionDelay.split(',')[0]\n\n  return (parseFloat(transitionDuration) + parseFloat(transitionDelay)) * MILLISECONDS_MULTIPLIER\n}\n\nconst triggerTransitionEnd = element => {\n  const evt = document.createEvent('HTMLEvents')\n\n  evt.initEvent(TRANSITION_END, true, true)\n  element.dispatchEvent(evt)\n}\n\nconst isElement = obj => (obj[0] || obj).nodeType\n\nconst emulateTransitionEnd = (element, duration) => {\n  let called = false\n  const durationPadding = 5\n  const emulatedDuration = duration + durationPadding\n  function listener() {\n    called = true\n    element.removeEventListener(TRANSITION_END, listener)\n  }\n\n  element.addEventListener(TRANSITION_END, listener)\n  setTimeout(() => {\n    if (!called) {\n      triggerTransitionEnd(element)\n    }\n  }, emulatedDuration)\n}\n\nconst typeCheckConfig = (componentName, config, configTypes) => {\n  Object.keys(configTypes)\n    .forEach(property => {\n      const expectedTypes = configTypes[property]\n      const value = config[property]\n      const valueType = value && isElement(value) ?\n        'element' :\n        toType(value)\n\n      if (!new RegExp(expectedTypes).test(valueType)) {\n        throw new Error(\n          `${componentName.toUpperCase()}: ` +\n          `Option \"${property}\" provided type \"${valueType}\" ` +\n          `but expected type \"${expectedTypes}\".`)\n      }\n    })\n}\n\nconst makeArray = nodeList => {\n  if (!nodeList) {\n    return []\n  }\n\n  return [].slice.call(nodeList)\n}\n\nconst isVisible = element => {\n  if (!element) {\n    return false\n  }\n\n  if (element.style && element.parentNode && element.parentNode.style) {\n    const elementStyle = getComputedStyle(element)\n    const parentNodeStyle = getComputedStyle(element.parentNode)\n\n    return elementStyle.display !== 'none' &&\n      parentNodeStyle.display !== 'none' &&\n      elementStyle.visibility !== 'hidden'\n  }\n\n  return false\n}\n\nconst findShadowRoot = element => {\n  if (!document.documentElement.attachShadow) {\n    return null\n  }\n\n  // Can find the shadow root otherwise it'll return the document\n  if (typeof element.getRootNode === 'function') {\n    const root = element.getRootNode()\n    return root instanceof ShadowRoot ? root : null\n  }\n\n  if (element instanceof ShadowRoot) {\n    return element\n  }\n\n  // when we don't find a shadow root\n  if (!element.parentNode) {\n    return null\n  }\n\n  return findShadowRoot(element.parentNode)\n}\n\nconst noop = () => function () {}\n\nconst reflow = element => element.offsetHeight\n\nconst getjQuery = () => {\n  const { jQuery } = window\n\n  if (jQuery && !document.body.hasAttribute('data-no-jquery')) {\n    return jQuery\n  }\n\n  return null\n}\n\nexport {\n  getjQuery,\n  TRANSITION_END,\n  getUID,\n  getSelectorFromElement,\n  getElementFromSelector,\n  getTransitionDurationFromElement,\n  triggerTransitionEnd,\n  isElement,\n  emulateTransitionEnd,\n  typeCheckConfig,\n  makeArray,\n  isVisible,\n  findShadowRoot,\n  noop,\n  reflow\n}\n","/**\n * --------------------------------------------------------------------------\n * CoreUI (v3.0.0-rc.3): sidebar.js\n * Licensed under MIT (https://coreui.io/license)\n * --------------------------------------------------------------------------\n */\n\nimport {\n  getjQuery,\n  reflow\n} from './util/index'\nimport Data from './dom/data'\nimport EventHandler from './dom/event-handler'\nimport PerfectScrollbar from 'perfect-scrollbar'\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME = 'sidebar'\nconst VERSION = '3.0.0-rc.3'\nconst DATA_KEY = 'coreui.sidebar'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n\nconst DefaultType = {\n  dropdownAccordion: '(string|boolean)'\n}\n\nconst Default = {\n  dropdownAccordion: true,\n  transition: 400\n}\n\nconst ClassName = {\n  ACTIVE: 'c-active',\n  BACKDROP: 'c-sidebar-backdrop',\n  FADE: 'c-fade',\n  NAV_DROPDOWN: 'c-sidebar-nav-dropdown',\n  NAV_DROPDOWN_TOGGLE: 'c-sidebar-nav-dropdown-toggle',\n  SHOW: 'c-show',\n  SIDEBAR_MINIMIZED: 'c-sidebar-minimized',\n  SIDEBAR_OVERLAID: 'c-sidebar-overlaid',\n  SIDEBAR_SHOW: 'c-sidebar-show'\n}\n\nconst Event = {\n  CLASS_TOGGLE: 'classtoggle',\n  CLICK: 'click',\n  CLICK_DATA_API: `click${EVENT_KEY}${DATA_API_KEY}`,\n  DESTROY: 'destroy',\n  INIT: 'init',\n  LOAD_DATA_API: `load${EVENT_KEY}${DATA_API_KEY}`,\n  TOGGLE: 'toggle',\n  UPDATE: 'update'\n}\n\nconst Selector = {\n  NAV_DROPDOWN_TOGGLE: '.c-sidebar-nav-dropdown-toggle',\n  NAV_DROPDOWN: '.c-sidebar-nav-dropdown',\n  NAV_LINK: '.c-sidebar-nav-link',\n  NAVIGATION_CONTAINER: '.c-sidebar-nav',\n  SIDEBAR: '.c-sidebar'\n}\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass Sidebar {\n  constructor(element) {\n    this._element = element\n    this.mobile = this._isMobile.bind(this)\n    this.ps = null\n    this._backdrop = null\n    this._perfectScrollbar(Event.INIT)\n    this._setActiveLink()\n    this._toggleClickOut()\n    this._clickOutListener = this._clickOutListener.bind(this)\n    this._addEventListeners()\n  }\n\n  // Getters\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  static get DefaultType() {\n    return DefaultType\n  }\n\n  // Private\n\n  _getAllSiblings(element, filter) {\n    const siblings = []\n    element = element.parentNode.firstChild\n    do {\n      if (element.nodeType === 3) {\n        continue // text node\n      }\n\n      if (!filter || filter(element)) {\n        siblings.push(element)\n      }\n\n    // eslint-disable-next-line no-cond-assign\n    } while (element = element.nextSibling)\n\n    return siblings\n  }\n\n  _toggleDropdown(event) {\n    let toggler = event.target\n    if (!toggler.classList.contains(ClassName.NAV_DROPDOWN_TOGGLE)) {\n      toggler = toggler.closest(Selector.NAV_DROPDOWN_TOGGLE)\n    }\n\n    const dataAttributes = toggler.closest(Selector.NAVIGATION_CONTAINER).dataset\n\n    if (typeof dataAttributes.dropdownAccordion !== 'undefined') {\n      Default.dropdownAccordion = JSON.parse(dataAttributes.dropdownAccordion)\n    }\n\n    // TODO: find better solution\n    if (Default.dropdownAccordion === true) {\n      this._getAllSiblings(toggler.parentElement).forEach(element => {\n        if (element !== toggler.parentNode) {\n          if (element.classList.contains(ClassName.NAV_DROPDOWN)) {\n            element.classList.remove(ClassName.SHOW)\n          }\n        }\n      })\n    }\n\n    toggler.parentNode.classList.toggle(ClassName.SHOW)\n    // TODO: Set the toggler's position near to cursor after the click.\n\n    this._perfectScrollbar(Event.UPDATE)\n  }\n\n  _closeSidebar(event) {\n    let link = event.target\n    if (!link.classList.contains(ClassName.NAV_LINK)) {\n      link = link.closest(Selector.NAV_LINK)\n    }\n\n    if (this.mobile && !link.classList.contains(ClassName.NAV_DROPDOWN_TOGGLE)) {\n      this._removeClickOut()\n      this._element.classList.remove(ClassName.SIDEBAR_SHOW)\n    }\n  }\n\n  _perfectScrollbar(event) {\n    if (typeof PerfectScrollbar !== 'undefined') {\n      if (event === Event.INIT && !this._element.classList.contains(ClassName.SIDEBAR_MINIMIZED)) {\n        this.ps = this._makeScrollbar()\n      }\n\n      if (event === Event.DESTROY) {\n        this._destroyScrollbar()\n      }\n\n      if (event === Event.TOGGLE) {\n        if (this._element.classList.contains(ClassName.SIDEBAR_MINIMIZED)) {\n          this._destroyScrollbar()\n        } else {\n          this._destroyScrollbar()\n          this.ps = this._makeScrollbar()\n        }\n      }\n\n      if (event === Event.UPDATE && !this._element.classList.contains(ClassName.SIDEBAR_MINIMIZED)) {\n        // TODO: Add smooth transition\n        setTimeout(() => {\n          this._destroyScrollbar()\n          this.ps = this._makeScrollbar()\n        }, Default.transition)\n      }\n    }\n  }\n\n  _makeScrollbar(container = Selector.NAVIGATION_CONTAINER) {\n    if (this._element.querySelector(container)) {\n      const ps = new PerfectScrollbar(this._element.querySelector(container), {\n        suppressScrollX: true\n      })\n      return ps\n    }\n  }\n\n  _destroyScrollbar() {\n    if (this.ps) {\n      this.ps.destroy()\n      this.ps = null\n    }\n  }\n\n  _getParents(element, selector) {\n    // Setup parents array\n    const parents = []\n\n    // Get matching parent elements\n    for (; element && element !== document; element = element.parentNode) {\n      // Add matching parents to array\n      if (selector) {\n        if (element.matches(selector)) {\n          parents.push(element)\n        }\n      } else {\n        parents.push(element)\n      }\n    }\n\n    return parents\n  }\n\n  _setActiveLink() {\n    // eslint-disable-next-line unicorn/prefer-spread\n    Array.from(this._element.querySelectorAll(Selector.NAV_LINK)).forEach(element => {\n      let currentUrl\n\n      const urlHasParams = /\\\\?.*=/\n      const urlHasQueryString = /\\\\?./\n      const urlHasHash = /#./\n\n      if (urlHasParams.test(String(window.location)) || urlHasQueryString.test(String(window.location))) {\n        currentUrl = String(window.location).split('?')[0]\n      } else if (urlHasHash.test(String(window.location))) {\n        currentUrl = String(window.location).split('#')[0]\n      } else {\n        currentUrl = String(window.location)\n      }\n\n      if (currentUrl.slice(- 1) === '#') {\n        currentUrl = currentUrl.slice(0, -1)\n      }\n\n      if (element.href === currentUrl) {\n        element.classList.add(ClassName.ACTIVE)\n        // eslint-disable-next-line unicorn/prefer-spread\n        Array.from(this._getParents(element, Selector.NAV_DROPDOWN)).forEach(element => {\n          element.classList.add(ClassName.SHOW)\n        })\n      }\n    })\n  }\n\n  _isMobile(event) {\n    return Boolean(window.getComputedStyle(event.target, null).getPropertyValue('--is-mobile'))\n  }\n\n  _clickOutListener(event) {\n    if (!this._element.contains(event.target)) { // or use: event.target.closest(Selector.SIDEBAR) === null\n      event.preventDefault()\n      event.stopPropagation()\n      this._removeClickOut()\n      this._element.classList.remove(ClassName.SIDEBAR_SHOW)\n    }\n  }\n\n  _addClickOut() {\n    document.addEventListener(Event.CLICK, this._clickOutListener, true)\n  }\n\n  _removeClickOut() {\n    document.removeEventListener(Event.CLICK, this._clickOutListener, true)\n    this._removeBackdrop()\n  }\n\n  _toggleClickOut() {\n    if (this.mobile && this._element.classList.contains(ClassName.SIDEBAR_SHOW)) {\n      this._addClickOut()\n      this._showBackdrop()\n    } else if (this._element.classList.contains(ClassName.SIDEBAR_OVERLAID) && this._element.classList.contains(ClassName.SIDEBAR_SHOW)) {\n      this._addClickOut()\n    } else {\n      this._removeClickOut()\n    }\n  }\n\n  _removeBackdrop() {\n    if (this._backdrop) {\n      this._backdrop.parentNode.removeChild(this._backdrop)\n      this._backdrop = null\n    }\n  }\n\n  _showBackdrop() {\n    if (!this._backdrop) {\n      this._backdrop = document.createElement('div')\n      this._backdrop.className = ClassName.BACKDROP\n      this._backdrop.classList.add(ClassName.FADE)\n      document.body.appendChild(this._backdrop)\n      reflow(this._backdrop)\n      this._backdrop.classList.add(ClassName.SHOW)\n    }\n  }\n\n  _addEventListeners() {\n    EventHandler.on(this._element, Event.CLASS_TOGGLE, event => {\n      if (event.detail.className === ClassName.SIDEBAR_MINIMIZED) {\n        this._perfectScrollbar(Event.TOGGLE)\n      }\n\n      if (event.detail.className === ClassName.SIDEBAR_SHOW) {\n        this._toggleClickOut()\n      }\n    })\n\n    EventHandler.on(this._element, Event.CLICK_DATA_API, Selector.NAV_DROPDOWN_TOGGLE, event => {\n      event.preventDefault()\n      this._toggleDropdown(event)\n    })\n\n    EventHandler.on(this._element, Event.CLICK_DATA_API, Selector.NAV_LINK, event => {\n      this._closeSidebar(event)\n    })\n  }\n\n  // Static\n\n  static _sidebarInterface(element, config) {\n    let data = Data.getData(element, DATA_KEY)\n    const _config = typeof config === 'object' && config\n\n    if (!data) {\n      data = new Sidebar(element, _config)\n    }\n\n    if (typeof config === 'string') {\n      if (typeof data[config] === 'undefined') {\n        throw new TypeError(`No method named \"${config}\"`)\n      }\n\n      data[config]()\n    }\n  }\n\n  static jQueryInterface(config) {\n    return this.each(function () {\n      Sidebar._sidebarInterface(this, config)\n    })\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\nEventHandler.on(window, Event.LOAD_DATA_API, () => {\n  // eslint-disable-next-line unicorn/prefer-spread\n  Array.from(document.querySelectorAll(Selector.SIDEBAR)).forEach(element => {\n    Sidebar._sidebarInterface(element)\n  })\n})\n\nconst $ = getjQuery()\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n* add .asyncLoad to jQuery only if jQuery is present\n */\n\nif ($) {\n  const JQUERY_NO_CONFLICT = $.fn[NAME]\n  $.fn[NAME] = Sidebar.jQueryInterface\n  $.fn[NAME].Constructor = Sidebar\n  $.fn[NAME].noConflict = () => {\n    $.fn[NAME] = JQUERY_NO_CONFLICT\n    return Sidebar.jQueryInterface\n  }\n}\n\nexport default Sidebar\n"],"names":["reflow","element","offsetHeight","getjQuery","window","jQuery","document","body","hasAttribute","NAME","VERSION","DATA_KEY","EVENT_KEY","DATA_API_KEY","DefaultType","dropdownAccordion","Default","transition","ClassName","ACTIVE","BACKDROP","FADE","NAV_DROPDOWN","NAV_DROPDOWN_TOGGLE","SHOW","SIDEBAR_MINIMIZED","SIDEBAR_OVERLAID","SIDEBAR_SHOW","Event","CLASS_TOGGLE","CLICK","CLICK_DATA_API","DESTROY","INIT","LOAD_DATA_API","TOGGLE","UPDATE","Selector","NAV_LINK","NAVIGATION_CONTAINER","SIDEBAR","Sidebar","_element","mobile","_isMobile","bind","ps","_backdrop","_perfectScrollbar","_setActiveLink","_toggleClickOut","_clickOutListener","_addEventListeners","_getAllSiblings","filter","siblings","parentNode","firstChild","nodeType","push","nextSibling","_toggleDropdown","event","toggler","target","classList","contains","closest","dataAttributes","dataset","JSON","parse","parentElement","forEach","remove","toggle","_closeSidebar","link","_removeClickOut","PerfectScrollbar","_makeScrollbar","_destroyScrollbar","setTimeout","container","querySelector","suppressScrollX","destroy","_getParents","selector","parents","matches","Array","from","querySelectorAll","currentUrl","urlHasParams","urlHasQueryString","urlHasHash","test","String","location","split","slice","href","add","Boolean","getComputedStyle","getPropertyValue","preventDefault","stopPropagation","_addClickOut","addEventListener","removeEventListener","_removeBackdrop","_showBackdrop","removeChild","createElement","className","appendChild","EventHandler","on","detail","_sidebarInterface","config","data","Data","getData","_config","TypeError","jQueryInterface","each","$","JQUERY_NO_CONFLICT","fn","Constructor","noConflict"],"mappings":"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"}